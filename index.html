<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chronicon</title>
    <link rel="stylesheet" href="css/reset.css" />
    <link href="https://fonts.googleapis.com/css?family=Alegreya+Sans" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
    <header>
        <h1 class="title">Chronicon Skill Tree Tool</h1>
    </header>
    <main>
        <div class="tool-container">
            <select>
                <option>Warlock</option>
            </select>
            <div class="skill-tree">
            </div>
        </div>
    </main>
    <footer>
        <p>&copy; RJ Industries 2017</p>
    </footer>
</body>
<script src="js/jquery-3.2.1.min.js"></script>
<script src="js/js.js"></script>
<script>
  document.oncontextmenu = function() {
    return false;
  };

    $(() => {
      const skillTree = $('.skill-tree');

      function populate() {
        let newMastery;
        for (const mastery in warlockMastery) {
          const currentMastery = warlockMastery[mastery];
          newMastery = new $('<div />');
          newMastery.addClass('mastery');
          const newContainer = new $('<div />');
          newContainer.addClass('skills-container');
          for (const skill in currentMastery) {
            const divContainer = new $('<div />');
            const imgSrc = currentMastery[skill].image;
            const skillImg = new $('<img />', {'src': imgSrc} );
            skillImg.addClass('skill-img');
            skillImg.attr('max', currentMastery[skill].maxRank);
            divContainer.append(skillImg);
            const counter = new $('<p />');
            counter.html('0');
            divContainer.append(counter);
            newContainer.append(divContainer);
          }
          newMastery.append(newContainer);
          skillTree.append(newMastery);
        }
      }

      populate();

      $(document).on('click', '.skill-img', function(e) {
        let current = parseInt($(this).next().html());
        let rowCurrent = parseInt($(this).parent().parent().children(':first-child').children(':first-child').next().html());
        if(current < $(this).attr('max') && ($(this).attr('max')) !== undefined) {
          current += 1;
          rowCurrent += 1;
          $(this).next().html(current);
          $(this).parent().parent().children(':first-child').children(':first-child').next().html(rowCurrent);
        }
      });
      $(document).on('mousedown', '.skill-img', function(e){
        if(e.which === 3) {
          let current = parseInt($(this).next().html());
          let rowCurrent = parseInt($(this).parent().parent().children(':first-child').children(':first-child').next().html());
          if(current > 0 && ($(this).attr('max')) !== undefined) {
            current -= 1;
            rowCurrent -= 1;
            $(this).next().html(current);
            $(this).parent().parent().children(':first-child').children(':first-child').next().html(rowCurrent)
          }
        }
      })
    })
</script>
</html>